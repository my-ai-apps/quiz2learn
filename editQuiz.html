<!--
/*!
Copyright Â© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
-->
<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Edit Quiz</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;line-height:1.6;background-color:var(--bg-color);color:var(--text-color)}:root{--bg-color:#f5f5f5;--text-color:#000;--card-bg:white;--primary-color:#673ab7}[data-theme=dark]{--bg-color:#121212;--text-color:#fff;--card-bg:#1e1e1e;--primary-color:#bb86fc}.header{background:var(--card-bg);padding:1rem;box-shadow:0 2px 4px rgba(0,0,0,.1);display:flex;justify-content:space-between;align-items:center}.header-left{display:flex;align-items:center;gap:1rem}.logo{font-size:1.5rem;font-weight:700;color:var(--primary-color);text-decoration:none}.header-right{display:flex;align-items:center;gap:1rem}.search-bar{flex:1;max-width:400px;margin:0 1rem}.search-bar input{width:100%;padding:.5rem;border:1px solid #ddd;border-radius:4px;background:var(--card-bg);color:var(--text-color)}.user-avatar{width:32px;height:32px;background:var(--primary-color);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700}.page-header{background:var(--primary-color);color:#fff;padding:1.5rem;margin-bottom:2rem}.page-header h1{font-size:1.5rem;margin:0}.container{max-width:1000px;margin:0 auto;padding:0 1rem}.quiz-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1rem;margin-bottom:2rem}.quiz-card{background:var(--card-bg);border-radius:8px;padding:1rem;box-shadow:0 2px 4px rgba(0,0,0,.1);cursor:pointer;transition:transform .2s,box-shadow .2s}.quiz-card:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.1)}.quiz-card h3{color:var(--primary-color);margin-bottom:.5rem}.quiz-editor{display:none;background:var(--card-bg);border-radius:8px;padding:1.5rem;margin-bottom:2rem}.quiz-editor.active{display:block}.question-list{margin-bottom:2rem}.question-item{background:#f8f8f8;border-radius:4px;padding:1rem;margin-bottom:1rem}.question-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.question-actions{display:flex;gap:.5rem}.btn{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:background-color .2s}.btn-primary{background:var(--primary-color);color:#fff}.btn-secondary{background:#f0f0f0;color:#333}.btn-danger{background:#dc3545;color:#fff}.options-list{margin-left:1.5rem}.option-item{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}.correct-answer{color:#28a745;font-weight:700}.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);align-items:center;justify-content:center;z-index:1000}.modal.active{display:flex}.modal-content{background:var(--card-bg);padding:2rem;border-radius:8px;width:90%;max-width:600px;max-height:90vh;overflow-y:auto}.form-group{margin-bottom:1rem}.form-group label{display:block;margin-bottom:.5rem;color:#333}input,select,textarea{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:4px;font-size:1rem}@media (max-width:768px){.search-bar{display:none}.header{padding:.75rem}.page-header{padding:1rem}.quiz-list{grid-template-columns:1fr}.modal-content{padding:1rem;width:95%}}</style></head><body><header class="header"><div class="header-left"><a href="#" class="logo">Edit Quiz</a></div><div class="search-bar"><input type="search" placeholder="Search for quizzes..."></div><div class="header-right"><button class="btn btn-primary" style="width:auto">+</button><div class="user-avatar">J</div></div></header><div class="page-header"><div class="container"><h1>Edit Quiz</h1></div></div><div class="container"><div id="quizSelection" class="quiz-list"><div class="quiz-card" onclick='selectQuiz("spanish-chapter-4")'><h3>Spanish Chapter 4</h3><p>15 questions</p><p>Time limit: 30s per question</p></div><div class="quiz-card" onclick='selectQuiz("math-algebra-1")'><h3>Math: Algebra 1</h3><p>20 questions</p><p>Time limit: 45s per question</p></div></div><div id="quizEditor" class="quiz-editor"><div class="question-list"></div><button class="btn btn-primary" onclick="showAddQuestion()">Add New Question</button></div></div><div id="questionModal" class="modal"><div class="modal-content"><h2 id="modalTitle">Add/Edit Question</h2><form id="questionForm"><input type="hidden" id="questionId" name="questionId"><div class="form-group"><label>Question Text</label> <textarea id="questionText" name="questionText" rows="3" required></textarea></div><div class="form-group"><label>Options</label><div id="optionsContainer"><input id="option0" name="option0" placeholder="Option 1" required> <input id="option1" name="option1" placeholder="Option 2" required> <input id="option2" name="option2" placeholder="Option 3" required> <input id="option3" name="option3" placeholder="Option 4" required></div></div><div class="form-group"><label>Correct Answer</label> <select id="correctAnswer" name="correctAnswer" required><option value="0">Option 1</option><option value="1">Option 2</option><option value="2">Option 3</option><option value="3">Option 4</option></select></div><div class="form-group" style="display:flex;gap:1rem"><button type="submit" class="btn btn-primary">Save Question</button> <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button></div></form></div></div><script type="module">import store from"./assets/js/store.js";let currentQuizFile="",currentQuiz=null;async function init(){const e=new URLSearchParams(window.location.search).get("q");if(e){currentQuizFile=e;try{const t=await fetch(`..${e}`);if(!t.ok)throw new Error(`Failed to load quiz: ${e}`);const r=(await t.text()).match(/export default ({[\s\S]*})/)[1];currentQuiz=JSON.parse(r),document.getElementById("quizTitle").value=currentQuiz.title||"",document.getElementById("quizSubject").value=currentQuiz.subject||"",document.getElementById("quizGrade").value=currentQuiz.grade||"",renderQuestions(currentQuiz.questions||[])}catch(e){console.error("Error loading quiz:",e),alert("Error loading quiz. Please try again.")}}else alert("No quiz specified")}async function saveQuiz(){if(currentQuizFile&&currentQuiz){currentQuiz.title=document.getElementById("quizTitle").value,currentQuiz.subject=document.getElementById("quizSubject").value,currentQuiz.grade=parseInt(document.getElementById("quizGrade").value);try{if(!(await fetch("/api/save-quiz",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file:currentQuizFile,quiz:currentQuiz})})).ok)throw new Error("Failed to save quiz");alert("Quiz saved successfully!")}catch(e){console.error("Error saving quiz:",e),alert("Error saving quiz. Please try again.")}}else alert("No quiz loaded")}document.addEventListener("DOMContentLoaded",init),document.getElementById("saveQuiz").addEventListener("click",saveQuiz)</script><script>let currentQuiz={id:"spanish-chapter-4",title:"Spanish Chapter 4",timeLimit:30,questions:[{id:1,text:'What is the Spanish word for "hello"?',options:["Hola","Adios","Gracias","Por favor"],correctAnswer:0}]};function selectQuiz(e){document.getElementById("quizSelection").style.display="none",document.getElementById("quizEditor").classList.add("active"),loadQuizData(e)}async function loadQuizData(e){try{renderQuestions(await quizLoader.loadQuizData(e))}catch(e){console.error("Failed to load quiz:",e)}}function renderQuestions(e){document.querySelector(".question-list").innerHTML=e.map(((e,t)=>`\n                <div class="question-item">\n                    <div class="question-header">\n                        <h3>Question ${t+1}</h3>\n                        <div class="question-actions">\n                            <button class="btn btn-secondary" onclick="editQuestion(${e.id})">Edit</button>\n                            <button class="btn btn-danger" onclick="deleteQuestion(${e.id})">Delete</button>\n                        </div>\n                    </div>\n                    <p>${e.text}</p>\n                    <div class="options-list">\n                        ${e.options.map(((t,n)=>`\n                            <div class="option-item">\n                                <span>${String.fromCharCode(65+n)})</span>\n                                <span class="${n===e.correctAnswer?"correct-answer":""}">${t}</span>\n                            </div>\n                        `)).join("")}\n                    </div>\n                </div>\n            `)).join("")}function editQuestion(e){const t=currentQuiz.questions.find((t=>t.id===e));t&&(document.getElementById("modalTitle").textContent="Edit Question",document.getElementById("questionId").value=t.id,document.getElementById("questionText").value=t.text,t.options.forEach(((e,t)=>{document.getElementById(`option${t}`).value=e})),document.getElementById("correctAnswer").value=t.correctAnswer,document.getElementById("questionModal").classList.add("active"))}function showAddQuestion(){document.getElementById("modalTitle").textContent="Add New Question",document.getElementById("questionForm").reset(),document.getElementById("questionId").value="",document.getElementById("questionModal").classList.add("active")}function closeModal(){document.getElementById("questionModal").classList.remove("active")}function saveQuestion(e){const t=e.get("questionId"),n={id:t?parseInt(t):Date.now(),text:e.get("questionText"),options:[e.get("option0"),e.get("option1"),e.get("option2"),e.get("option3")],correctAnswer:parseInt(e.get("correctAnswer"))};if(t){const e=currentQuiz.questions.findIndex((e=>e.id===parseInt(t)));-1!==e&&(currentQuiz.questions[e]=n)}else currentQuiz.questions.push(n);renderQuestions(currentQuiz.questions)}function deleteQuestion(e){confirm("Are you sure you want to delete this question?")&&(currentQuiz.questions=currentQuiz.questions.filter((t=>t.id!==e)),renderQuestions(currentQuiz.questions))}document.getElementById("questionForm").addEventListener("submit",(function(e){e.preventDefault();saveQuestion(new FormData(this)),closeModal()}))</script><script src="assets/js/common.js"></script></body></html>